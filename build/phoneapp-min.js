'use strict';(function(){this.Pa=this.Em=this.Ember=this.PhoneApp={K:function(){},TEMPLATES:Handlebars.templates||{},ENV:{HANDLEBARS_EXPOSE_OBJECTS:[]}}}).apply(this);
(function(b){var f=[],d,a=[],h,c=function(){d&&(f.push(d),d=null);if(h){if(!h.name)throw Error('NEED_A_NAME: Trying to bind "something" without any name');a.push(h);h=null}},g=function(a,i,c){i.split(".").forEach(function(b){if(!a||!(b in a))if(c)return a=void 0;else throw Error("MISSING: Trying to require something that doesn't exist"+i);a=a[b]});return a},e=function(a,i){var c={};i.split(".").forEach(function(i){c.o=a;c.k=i;i in a||(a[i]={});a=a[i]});return c},i=function(){c();var i=f,e=a;f=[];
a=[];var d={};e.forEach(function(a){if(a.name in d)throw Error("ALREADY_DEFINED: You are shadowing "+d[a.name]+" with "+a+" for name "+a.name);d[a.name]=a.value});i.forEach(function(a){if(a.name in d)throw Error("ALREADY_DEFINED: You are shadowing name "+a.name);d[a.name]=g(b,a.module,a.optional)});return d};this.use=function(a,i){c();d={module:a,name:a.split(".").pop(),optional:i};return this};this.add=function(a,i){if(a===void 0&&!i)throw Error("UNDEFINED: Requesting something local that is undefined");
c();h={value:a};return this};this.as=function(a){if(d)d.name=a;else if(h)h.name=a;c()};this.pack=function(a,c){var d=i(),g=e(b,a);(d=c.apply(g.o[g.k],[d]))&&(g.o[g.k]=d)};this.run=function(a){var c=i();a.apply({},[c])}}).apply(PhoneApp,[window]);
PhoneApp.pack("PhoneApp.types",function(){var b=0,f={};this.Object=function(){this.__class__="[PhoneApp.Object]"};this.Object.prototype.toString=function(){return this.__class__};var d=function(a,c,b){var e,d=true,g,m,n;b.__property__.forEach(function(q){var o=h(this,q)||h(window,q);if(o){m=o.shift();n=o.shift();var s=f[this.__id__];m.addObserver(n,function(f,h,o){g=[void 0,m,n,o];if(s[c]){var q=e,r=b.apply(a,g);q!=r&&(e=r,s[c].forEach(function(b){window.setTimeout(function(){b.collapse&&a[c]!==r||
b.apply(a,[c,q,r])},1)}))}else d=true})}else console.error("Trying to property non-existent",q)},a);Object.defineProperty(a,c,{enumerable:true,configurable:true,get:function(){d&&(d=false,g||(g=[void 0,m,n,m&&m[n]]),e=b.apply(this,g));return e},set:function(a){g?g[0]=a:g=[a,m,n];e=b.apply(this,g);g[0]=void 0;return e}})},a=/[A-Za-z0-9]Binding$/;this.Object.create=this.Object.prototype.create=function(i){i=new (this.extend(i));f[i.__id__=b++]={};var c=[],e;for(e in i)c.push(e);c.forEach(function(c){var i=
this[c];i&&(a.test(c)?(PhoneApp.Binding.bind(this,c.substr(0,c.length-7),i),this.hasOwnProperty(c)?delete this[c]:delete Object.getPrototypeOf(this)[c]):(i.hasOwnProperty("__observes__")&&i.__observes__.forEach(function(a){var c=h(this,a)||h(window,a);if(c){var b=c.shift(),e=c.shift();if(!("addObserver"in b))throw Error("NOT_OBSERVABLE: "+b);b.addObserver(e,function(){i.apply(b,[b,e])})}else console.error("Trying to observe non existent",a)},this),i.hasOwnProperty("__property__")&&d(this,c,i)))},
i);i.init();return i};this.Object._super=this.Object.prototype._super=function(a,c,b){return this.prototype[a].apply(c||this,b)};this.Object.extend=this.Object.prototype.extend=function(a){var a=a||{},c;c=a.constructor!=Function?function(){Object.keys(a).forEach(function(c){this[c]=a[c]},this)}:a;c.prototype=new this;c.extend=this.extend;c.create=this.create;c._super=this._super;return c};this.Object.prototype.init=function(){};this.Object.prototype.addObserver=function(a,c,b){a in f[this.__id__]||
(f[this.__id__][a]=[]);a=f[this.__id__][a];if(a.indexOf(c)==-1)c.collapse=b===void 0||b,a.push(c)};this.Object.prototype.removeObserver=function(a,c){if(a in f[this.__id__]){var b=f[this.__id__][a],e=b.indexOf(c);e!=-1&&b.splice(e,1)}};this.Object.prototype.set=function(a,b){var e=c(this,a),g=e.shift(),a=e.shift(),d=g[a];b!==d&&(g[a]=b,(f[g.__id__][a]||[]).forEach(function(c){window.setTimeout(function(){c.collapse&&g[a]!==b||c.apply(g,[a,d,b])},1)}))};this.Object.prototype.destroy=function(){delete f[this.__id__];
for(var a in this)delete this[a]};this.Object.isExtensionOf=function(a,c){return a&&a.prototype&&a.prototype instanceof c};var h=function(a,c){for(var b=c.split(".");a&&b.length>1;)a=a[b.shift()];a&&!(b[b.length-1]in a)&&(a=null);return a?[a,b.shift()]:void 0},c=function(a,c){for(var b=c.split("."),e;b.length>1;)e=b.shift(),e in a||(a[e]={}),a=a[e];return[a,b.shift()]};PhoneApp.get=this.Object.prototype.get=function(a){(a=h(this,a)||h(window,a))&&(a=a.shift()[a.pop()]);return a};var g,e;PhoneApp.Binding=
{oneWay:function(a){return function(a,c,b,e){return e}.property(a)},bothWays:function(a){return function(a,c,b,e){if(a===void 0)return e;c.set(b,a);return a}.property(a)},from:function(a){g=a;return this},to:function(a){e=a;return this},connect:function(a){this.bind(a,e,g);e=g=void 0},bind:function(a,c,b){d(a,c,this.bothWays(b))}};Function.prototype.observes=function(){this.__observes__=Array.prototype.slice.call(arguments);return this};Function.prototype.property=function(){this.__property__=Array.prototype.slice.call(arguments);
return this}});PhoneApp.use("PhoneApp.types.Object");
PhoneApp.pack("PhoneApp.types",function(b){Array.prototype.replace=function(a,b,c){var g;c===void 0&&(c=[]);if(!c||c.constructor!=Array)c=[c];g=c.map(function(a){return a});g.unshift(b);g.unshift(a);var e=Array.prototype.splice.apply(this,g);"__hashcache__"in this&&this.__hashcache__.forEach(function(b){window.setTimeout(function(){b.apply(this,[a,c,e])}.bind(this),1)},this);return e};Array.prototype.popObject=function(){return this.replace(this.length-1,1)};Array.prototype.pushObject=function(a){return this.replace(this.length,
0,a)};Array.prototype.shiftObject=function(){return this.replace(0,1)};Array.prototype.unshiftObject=function(a){return this.replace(0,0,a)};Array.prototype.removeObject=function(a){a=this.indexOf(a);if(a!=-1)return this.replace(a,1)};Array.prototype.insertAt=function(a,b){return this.replace(a,0,b)};Array.prototype.removeAt=function(a){return this.replace(a,1)};Array.prototype.clear=function(){return this.replace(0,this.length)};Array.prototype.removeArrayObserver=function(a){"__hashcache__"in this&&
(a=this.__hashcache__.indexOf(a),a!=-1&&this.__hashcache__.splice(a,1))};Array.prototype.addArrayObserver=function(a){if(!("__hashcache__"in this))this.__hashcache__=[];this.__hashcache__.push(a)};var f=function(a,b,c){if(b!=c){var g=a[b],g=a.replace(c,1,g);a.replace(b,1,g)}},d=function(a,b,c,g){if(!(c>=g)){f(a,c,Math.floor((c+g)/2));var e,i=c;for(e=c+1;e<=g;e++)b(a[e],a[c])<0&&f(a,++i,e);f(a,c,i);d(a,b,c,i-1);d(a,b,i+1,g)}};Array.prototype.quickSort=function(a){d(this,a,0,this.length-1);return this};
this.ArrayController=b.Object.extend({length:0,init:function(){b.Object._super("init",this);var a=false,d=false,c=false,g=false,e=[],i=function(){return true},f=function(a){return a},l=function(a,c){return a<c?-1:a==c?0:1},j=Infinity,k=function(a,b,k){k.forEach(function(b){b=d.indexOf(b,a);b!=-1&&(d.splice(b,1),b=c.splice(b,1).pop(),b=g.indexOf(b),g.splice(b,1),b<e.length&&e.replace(b,1))});b.forEach(function(b){if(i(b)){d.splice(a,0,b);b=f(b);c.splice(a,0,b);var o=0;g.some(function(a,c){l(b,a)>=
0&&(o=c+1);return l(b,a)<0});g.splice(o,0,b);o<=e.length&&o<j&&e.replace(o,0,b)}});e.length>j&&e.replace(j,e.length-j);j!=Infinity&&e.length<j&&e.length<g.length&&e.replace(e.length,0,g.slice(e.length,j));this.set("length",e.length)}.bind(this);this.destroy=function(){a.removeArrayObserver(k);g=c=d=a=false;this.set("length",0);e.clear()};Object.defineProperty(this,"original",{get:function(){return a}});Object.defineProperty(this,"content",{enumerable:true,get:function(){return e},set:function(b){a&&
a.removeArrayObserver(k);a=b;a.addArrayObserver(k);d=a.filter(i);c=d.map(f);g=Array.from(c);g.quickSort(l);e.clear();g.some(function(a){e.pushObject(a);return e.length==j});this.set("length",e.length)}});Object.defineProperty(this,"filter",{get:function(){return i},set:function(b){i=b;a&&(d=a.filter(i),c=d.map(f),g=Array.from(c),g.quickSort(l),e.clear(),g.some(function(a){e.pushObject(a);return e.length==j}),this.set("length",e.length))}});Object.defineProperty(this,"map",{get:function(){return f},
set:function(b){f=b;a&&(c=d.map(f),g=Array.from(c),g.quickSort(l),e.clear(),g.some(function(a){e.pushObject(a);return e.length==j}),this.set("length",e.length))}});Object.defineProperty(this,"sort",{get:function(){return l},set:function(b){l=b;a&&(g.quickSort(l),e.clear(),g.some(function(a){e.pushObject(a);return e.length==j}),this.set("length",e.length))}});Object.defineProperty(this,"limit",{get:function(){return j},set:function(b){j=b;a&&(e.length>j?e.replace(j,e.length-j):e.replace.apply(e,[e.length,
0,g.slice(e.length,j)]),this.set("length",e.length))}})}})});PhoneApp.add(Error).as("NativeError");
PhoneApp.pack("PhoneApp.types",function(b){this.Error=function(f,d){var a=b.NativeError.apply(this,[d]);if(!(this==window||this===void 0))if(this.message=a.message,this.stack=a.stack,this.name=f,!this.stack)this.stack=printStackTrace()};Object.getOwnPropertyNames(b.NativeError.prototype).forEach(function(f){f!="constructor"&&(this.Error.prototype[f]=b.NativeError.prototype[f])},this);"NOT_IMPLEMENTED,UNSPECIFIED,NOT_INITIALIZED,WRONG_ARGUMENTS,UNSUPPORTED,NATURAL_BORN_CRASH".split(",").forEach(function(b,d){this.Error[b]=
this.Error.prototype[b]=d},this);this.Error.prototype.toString=function(){return this.name+": "+this.message+"\nStack: "+(typeof this.stack=="array"?this.stack.join("\n"):this.stack)}});PhoneApp.use("PhoneApp.types.Error");
PhoneApp.pack("PhoneApp.service",function(b){this.Error=function(f,d,a){b.Error.apply(this,arguments);this.details=a};this.Error.prototype=Object.create(b.Error.prototype);"OPENING_FAILED,SEND_FAILED,FAILED_UID,MEANINGLESS_DATA,BAD_REQUEST,MISSING,BAD_REQUEST,UNAUTHORIZED,INVALID_SIGNATURE,WRONG_CREDENTIALS,SHOULD_NOT_HAPPEN,SERVICE_UNAVAILABLE,UNAUTHORIZED,UNSPECIFIED".split(",").forEach(function(b){this[b]=this.prototype[b]=b},this.Error)});PhoneApp.add(XMLHttpRequest).as("XMLHttpRequest");PhoneApp.use("PhoneApp.service.Error");
PhoneApp.pack("PhoneApp.service",function(b){var f=typeof File!="undefined"&&typeof Blob!="undefined";this.SimpleClient=function(){var a,d="",c="",g="",e=b.XMLHttpRequest;this.configure=function(b){if(b.host)a=b.host;if(b.port)d=b.port;b.scheme&&(g=b.scheme+":");if(b.version)c=b.version;if(b.backend)e=b.backend};Object.defineProperty(this,"Backend",{get:function(){return e}});this.url=function(b){var e=g+"//"+a+(d?":"+d:"")+(c?"/"+c:"");b.service&&(e+="/"+b.service);b.id&&(e+="/"+encodeURIComponent(b.id));
b.command&&(e+="/"+b.command);b.additional&&(e+="/"+b.additional.map(encodeURIComponent).join("/"));if(!b.params)b.params={};var f=[];Object.keys(b.params).forEach(function(a){f.push(encodeURIComponent(a)+"="+encodeURIComponent(b.params[a]))});f.length&&(e+="?"+f.join("&"));return e}};var d=function(){var a=this.inner,d=this.options.onfailure,c=this.options.onsuccess;if(a)if(a.readyState==a.FAILED_OPENING)this.inner=this.engine=this.options.onsuccess=this.options.onfailure=a.onreadystatechange=null,
this.error=new b.Error(b.Error.UNAUTHORIZED,"Not authorized to access this",this),d&&d(this.error);else{if(a.readyState==a.DONE){var g=this.engine;this.inner=this.engine=this.options.onsuccess=this.options.onfailure=a.onreadystatechange=null;try{if(a.responseText)this.data=JSON.parse(a.responseText)}catch(e){try{this.data=(new DOMParser).parseFromString(a.responseText,"application/xml")}catch(f){this.data=a.responseText,this.error=new b.Error(b.Error.MEANINGLESS_DATA,"WHAT? ALBATROS?",this)}}switch(a.status){case 200:case 201:break;
case 308:this.options.url=a.getResponseHeader("Location");g.query(g.GET,this.options,this.headers);return;case 400:this.error=new b.Error(b.Error.BAD_REQUEST,"Bad request!",this);break;case 401:this.error=a.getResponseHeader("WWW-Authenticate")?new b.Error(b.Error.WRONG_CREDENTIALS,"Wrong street cred",this):new b.Error(b.Error.INVALID_SIGNATURE,"Invalid singing",this);break;case 402:case 403:case 405:case 501:this.error=new b.Error(b.Error.UNAUTHORIZED,"Not authorized to access this",this);break;
case 404:this.error=new b.Error(b.Error.MISSING,"Missing resource",this);break;case 406:case 411:case 412:case 413:case 414:case 415:case 416:case 417:this.error=new b.Error(b.Error.SHOULD_NOT_HAPPEN,"Should never happen",this);break;case 500:case 503:this.error=new b.Error(b.Error.SERVICE_UNAVAILABLE,"Server is down",this);break;case 0:this.error=new b.Error(b.Error.UNAUTHORIZED,"Not authorized to access this",this);break;default:this.error=new b.Error(b.Error.UNSPECIFIED,"WTF?",this)}if(this.error)throw d&&
d(this.error),this.error;c&&c(this.data)}}else console.warn("BAD SHIT HAPPENED!")};this.SimpleClient.prototype.query=function(a,h,c){var g=new this.Backend,a=a||this.GET,e=h.url||this.url(h);c||(c={});if(!c.Accept)c.Accept="application/json";var i={options:h,method:a,headers:c,error:null,data:{},exception:null};g.onreadystatechange=d.bind(i);try{g.open(a,e,true)}catch(t){i.exception=t.toString();i.error=new b.Error(b.Error.OPENING_FAILED,"Failed opening likely bogus request",i);if(h.onfailure)h.onfailure(i.error);
throw i.error;}e=h.payload;if(a==this.POST&&(c["Content-Type"]||(c["Content-Type"]=f&&(e instanceof File||e instanceof Blob)?e.type:"application/json"),c["Content-Type"]=="application/json"))try{e=JSON.stringify(e)}catch(l){c["Content-Type"]="application/octet-stream"}Object.keys(c).forEach(function(a){g.setRequestHeader(a,c[a])});try{g.send(e)}catch(j){i.exception=j.toString();i.error=new b.Error(b.Error.SEND_FAILED,"Failed sending. Bogus payload?",i);if(h.onfailure)h.onfailure(i.error);throw i.error;
}i.inner=g;i.engine=this};this.SimpleClient.HEAD=this.SimpleClient.prototype.HEAD="HEAD";this.SimpleClient.GET=this.SimpleClient.prototype.GET="GET";this.SimpleClient.POST=this.SimpleClient.prototype.POST="POST";this.SimpleClient.PATCH=this.SimpleClient.prototype.PATCH="PATCH";this.SimpleClient.PUT=this.SimpleClient.prototype.PUT="PUT";this.SimpleClient.DELETE=this.SimpleClient.prototype.DELETE="DELETE"});
PhoneApp.pack("PhoneApp",function(){this.Run=function(b,a){var f=null;this.start=function(){f=window.setInterval(a,b)};this.stop=function(){window.clearInterval(f)}};var b=[],f=[];this.renderLoop={add:function(d,a,f){b.push({view:d,operation:a,callback:f})},schedule:function(d,a,f){b.push({view:a,operation:"schedule",callback:d,extra:f})},hook:function(b){f.indexOf(b)==-1&&f.push(b)}};(function(b,a){var f,c=Date.now(),g=function(e){f!==false&&(requestAnimationFrame(g,a),f=b(e-c,e),c=e)};g()})(function(d){if(!(d>
160)){for(var d=b.shift(),a,h=[];d;){a=d.view;if(d.operation=="schedule")d.callback.apply(a,d.extra);else{var c=document.getElementById(a.elementId);if(d.operation=="render"){if(!c){h.push(d);d=b.shift();continue}a.render(c)}else d.operation=="destroy"&&c&&a.element.parentNode.removeChild(a.element);d.callback&&d.callback.call(a,d.operation)}d=b.shift()}f.forEach(function(a){a()});b=h;return true}})});
PhoneApp.pack("PhoneApp.types",function(){var b={};String.prototype.dasherize=function(){return!this.length?"":b[this]||(b[this]=this.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase())};String.prototype.replaceAt=function(b,d){return this.substr(0,b)+d+this.substr(b+d.length)}});PhoneApp.use("PhoneApp.types.Object");
PhoneApp.pack("PhoneApp",function(b){this.Application=b.Object.extend({rootElement:$("body").get(0),ready:PhoneApp.K,autoHideSplash:false,device:b.Object.create({states:{BACKGROUND:"background",RUNNING:"running"},state:null,isIphone:false,isIpad:false,isRetina:false,isAndroid:false,isMobile:function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)}.property()}),network:b.Object.create({types:window.Connection||{},states:{ONLINE:"online",OFFLINE:"offline"},type:null,state:null}),
hideSplash:function(){this.device.isMobile&&navigator.splashscreen.hide&&navigator.splashscreen.hide()},onDeviceReady:function(){var b;$(this.rootElement).empty();this.rootView.controller=this.rootController;this.rootView.appendTo(this.rootElement);window.devicePixelRatio>1&&this.device.set("isRetina",true);this.device.isMobile&&(window.KeyboardToolbarRemover&&cordova.require("cordova/plugin/keyboard_toolbar_remover").hide(),this.autoHideSplash&&this.hideSplash(),window.device&&(b=window.device.platform.toLowerCase(),
b.indexOf("iphone")!==-1?this.device.set("isIphone",true):b.indexOf("ipad")!==-1?this.device.set("isIpad",true):b.indexOf("android")!=-1&&this.device.set("isAndroid",true),(new PhoneApp.Run(1E3,function(){navigator.connection.type==window.Connection.NONE&&this.network.set("state",this.network.states.OFFLINE);navigator.connection.type!=this.networkType&&this.network.set("type",navigator.connection.type)}.bind(this))).start()));this.router.transitionTo("index")},bindPhoneGapEvents:function(){document.addEventListener("deviceready",
function(){this.onDeviceReady();this.ready()}.bind(this),false);document.addEventListener("pause",function(){this.device.set("state",this.device.states.BACKGROUND);this.onPause()}.bind(this),false);document.addEventListener("resume",function(){this.device.set("state",this.device.states.RUNNING);this.onResume()}.bind(this),false);document.addEventListener("online",function(){this.network.set("state",this.network.states.ONLINE)}.bind(this),false);document.addEventListener("offline",function(){this.network.set("state",
this.network.states.OFFLINE)}.bind(this),false)},initialize:function(){if(this.device.isMobile)this.bindPhoneGapEvents();else this.onDeviceReady()}})});PhoneApp.use("PhoneApp.types.Object");
PhoneApp.pack("PhoneApp",function(b){var f=function(b,a){var h=b.split("."),c=[];Object.keys(h).forEach(function(g){var e=h[g];if(!(g==h.length-1&&e=="index"))if(e in a)a=a[e],c.push({path:e,route:a});else throw Error("unknown path "+b);});a.index&&a.index.redirectsTo&&c.push.apply(c,f(a.index.redirectsTo,a));return c};this.Route=b.Object.extend({_childs:{},route:null,enter:PhoneApp.K,redirectsTo:null,connectOutlets:PhoneApp.K,parentRoot:null,init:function(){Pa.Route._super("init",this);for(var d in this)if(b.Object.isExtensionOf(this[d],
Pa.Route))this[d]=this[d].create(),this[d].parentRoot=this,this._childs[d]=this[d]},toString:function(){return"PhoneApp.Route"}});this.Router=b.Object.extend({enableLogging:false,root:PhoneApp.Route,currentPath:null,controllers:{},init:function(){Pa.Router._super("init",this);this.root=this.root.create()},toString:function(){return"PhoneApp.Router"}});this.Router.prototype.transitionTo=function(b,a){var h=f(b,this.root),c=h.length-1,g="root";h.forEach(function(b,d){g+="."+b.path;b.route.enter(this,
a);d==c&&(this.set("currentPath",g),b.route.connectOutlets(this,a))},this)}});PhoneApp.use("PhoneApp.types.Object");PhoneApp.pack("PhoneApp",function(b){this.Controller=b.Object.extend({isController:true,content:null,connectOutlet:function(b){var d=b.viewClass,a=b.controller||this,h=b.context||null,b=b.outletName||"view";a&&h&&a.set("content",h);d=d.create();d.set("controller",a);this.set(b,d)},removeOutlet:function(b){this.set(b,null)}})});
PhoneApp.pack("PhoneApp",function(){var b=0;this.Metamorph=function(f,d,a){this.id=++b;this.startNodeId="metamorph-"+this.id+"-start";this.endNodeId="metamorph-"+this.id+"-end";var h=function(a,b,e){var a=document.getElementById(this.startNodeId),d=document.getElementById(this.endNodeId);if(!a||!d)throw Error("Miss Metamorph hooks");var h=a.nextSibling;PhoneApp.renderLoop.schedule(function(){if(typeof e=="string")h==d?d.parentNode.insertBefore(d,document.createTextNode(e||"")):h.textContent=e||"";
else{var a=e?e.render():document.createTextNode("");if(e)e._parentView=f,f._childViews.push(e),e.willInsertElement();h==d?d.parentNode.insertBefore(a,d):h.parentNode.replaceChild(a,h);e&&e.didInsertElement();b&&b.isView&&b.destroy()}})}.bind(this);d.addObserver(a,h);this.renderWrapper=function(){return'<script id="'+this.startNodeId+'"><\/script>'+(d.get(a)||"")+'<script id="'+this.endNodeId+'"><\/script>'};this.destroy=function(){d.removeObserver(a,h)}}});PhoneApp.use("PhoneApp.types.Object");
PhoneApp.pack("PhoneApp",function(b){var f=0,d=0,a=function(a){var a=a.split(":"),b=a[0],e="",d,f,h=b.split("."),j=h.pop(),h=h.join(".");a.length>1&&(d=a[1],a.length===3&&(f=a[2]),e=":"+d,f&&(e+=":"+f));return{path:b,property:j,parent:h,classNames:e,className:d===""?void 0:d,falsyClassName:f}},h=function(a,b,e){a&&(e?a.setAttribute(b,e):a.removeAttribute(b))};this.View=b.Object.extend({template:null,templateName:null,controller:null,classNames:null,attributeBindings:null,classNameBindings:null,willInsertElement:PhoneApp.K,
didInsertElement:PhoneApp.K,willDestroyElement:PhoneApp.K,isView:true,tagName:"div",element:null,elementId:null,_parentView:null,_childViews:null,_compiledTpl:null,_isDestroying:false,_meta_observers:null,_metamorphs:null,context:function(){var a=this.controller;if(!a&&this._parentView&&this._parentView.controller)a=this._parentView.controller;var b={};PhoneApp.ENV.HANDLEBARS_EXPOSE_OBJECTS.forEach(function(a){b[a]=window[a]});b.controller=a;b.view=this;return b}.property("controller"),init:function(){PhoneApp.View._super("init",
this);this.elementId="phoneapp"+this.__id__;this._childViews=[];if(!this.attributeBindings)this.attributeBindings=[];if(this.classNameBindings){if(typeof this.classNameBindings=="string")this.classNameBindings=this.classNameBindings.split(/\s+/)}else this.classNameBindings=[];if(this.classNames){if(typeof this.classNames=="string")this.classNames=this.classNames.split(" ")}else this.classNames=[];this._meta_observers=[];this._metamorphs=[];var a=null;if(this.template)a=this.template;else if(this.templateName&&
(a=PhoneApp.TEMPLATES[this.templateName],!a))throw Error("unknown template : "+this.templateName);this._compiledTpl=a||PhoneApp.K},$:function(a){return a?$(this.element).find(a):$(this.element)},appendTo:function(a){this.willInsertElement();var b=this.render();$(b).appendTo(a);this.didInsertElement()},insertChildAt:function(a,b){this.willInsertElement();PhoneApp.renderLoop.schedule(function(){this.element.insertBefore(a.renderWrapper(),this.element.children[b]);a.didInsertElement()},this);a._parentView=
this;this._childViews.push(a);return a},appendChild:function(a){a.willInsertElement();PhoneApp.renderLoop.add(a,"render",function(){this.didInsertElement()});a._parentView=this;this._childViews.push(a);return a},rerender:function(){return Pa.renderLoop.schedule(function(){this.render(this.element)},this)},renderWrapper:function(){var a=[],b="",e;this.attributeBindings.forEach(function(b){a.push({attribute:b,value:b})},this);b=this.classNames.join(" ");this.classNameBindings&&a.push({attribute:"class",
value:this.classNameBindings});a=this._computeAttributesBindings(a);b&&(a["class"]+=b);e=document.createElement(this.tagName);Object.keys(a).forEach(function(b){a[b]&&e.setAttribute(b,a[b])});e.setAttribute("id",this.elementId);return e},render:function(a){if(this._isDestroying)throw Error("Trying to render a destroyed view");a||(a=this.renderWrapper());this.element=a;this.element.innerHTML=this._compiledTpl(this.context)||"";return this.element},_computeAttributesBindings:function(b,d){var e={"class":"",
style:""},f=this;b.forEach(function(b){var c=b.attribute,b=b.value,j='[data-phoneapp-binding="'+d+'"]',k;if(c=="class")typeof b=="string"&&(b=b.split(/\s+/)),b.forEach(function(b){var c=a(b);!c.path&&c.className?e["class"]+=" "+c.className:(c.parent=c.parent?this.get(c.parent):this,b=function(a,b,d,g){if(!f._isDestroying){!k&&!g&&(k=!j?f.element:f.element.querySelector(j));k&&(e["class"]=k.getAttribute("class"));a=typeof d;if(a=="boolean"||a=="number"){if(!c.className)c.className=c.property.dasherize();
e["class"]=e["class"].replace(c.className,"").replace(c.falsyClassName,"");d?e["class"]+=" "+c.className:c.falsyClassName&&(e["class"]+=" "+c.falsyClassName)}else a=="string"&&(e["class"]=e["class"].replace(b,d));g||Pa.renderLoop.schedule(h,f,[k,"class",e["class"]])}},b(c.property,"",this.get(c.path),true),this._meta_observers.push({parent:c.parent,property:c.property,callback:b}),c.parent.addObserver(c.property,b))},this);else if(c=="style")typeof b=="string"&&(b=b.split(/\s+/)),b.forEach(function(b){var c=
a(b);c.styleName=c.className;c.styleValue=c.falsyClassName;c.isBinding=c.styleValue.indexOf("{{this}}")!=-1;!c.path&&!c.isBinding?e.style+=" "+c.styleName+":"+c.styleValue:(c.parent=c.parent?this.get(c.parent):this,b=function(a,b,d,g){if(!f._isDestroying){!k&&!g&&(k=!j?f.element:f.element.querySelector(j));if(k)e.style=k.getAttribute("style");var l={};(e.style||"").split(";").forEach(function(a){a&&(a=a.split(":"),l[a.shift().trim()]=a.shift())});d?l[c.styleName.trim()]=c.styleValue.replace("{{this}}",
d):delete l[c.styleName.trim()];e.style="";Object.keys(l).forEach(function(a){e.style+=a+":"+l[a]+";"});g||Pa.renderLoop.schedule(h,f,[k,"style",e.style])}},b(c.property,"",this.get(c.path),true),this._meta_observers.push({parent:c.parent,property:c.property,callback:b}),c.parent.addObserver(c.property,b))},this);else{var p=b.split("."),m=p.pop(),p=p.join("."),n,p=p?this.get(p):this;n=function(a,b,d,g){!f._isDestroying&&e[c]!=d&&(e[c]=d,g||(k||(k=!j?f.element:f.element.querySelector(j)),Pa.renderLoop.schedule(h,
f,[k,c,e[c]])))};n(m,"",this.get(b),true);this._meta_observers.push({parent:p,property:m,callback:n});p.addObserver(m,n)}},this);return e},_addAction:function(a,b,e,f){var h=++d;$(this.element).on(a,'[data-phoneapp-action="'+h+'"]',function(a){a.context=e;b.call(f,a)}.bind(this));return"data-phoneapp-action="+h},_addAttributeBindings:function(a){var b=++f,d;d=this._computeAttributesBindings(a,b);var h="data-phoneapp-binding="+b;Object.keys(d).forEach(function(a){d[a]&&(h+=" "+a+'="'+d[a]+'"')});return h},
_addMetamorph:function(a,b){var d=new PhoneApp.Metamorph(this,a,b);this._metamorphs.push(d);return d},destroy:function(a){this.willDestroyElement();this._isDestroying=true;this._meta_observers.forEach(function(a){a.parent.removeObserver(a.property,a.callback)});this._metamorphs.forEach(function(a){a.destroy()});a||this._parentView&&this._parentView._isDestroying?this._destroyElement():PhoneApp.renderLoop.add(this,"destroy",this._destroyElement)},_destroyElement:function(){this._childViews.forEach(function(a){a.destroy()});
this._parentView&&!this._parentView._isDestroying&&this._parentView._childViews.removeObject(this);$(this.element).off();PhoneApp.View._super("destroy",this)}})});PhoneApp.use("PhoneApp.types.Object");
PhoneApp.pack("PhoneApp",function(){this.CollectionView=this.View.extend({content:null,_childTemplate:null,_domTree:null,_replaceTree:null,init:function(){PhoneApp.CollectionView._super("init",this);this._domTree=document.createDocumentFragment();this._boundingIndex={start:0,end:Infinity};this._replaceTree={}},didInsertElement:function(){this.content&&(this.content.content.length&&this._domController(0,this.content.content,[]),this.content.content.addArrayObserver(this._domController.bind(this)),
this.addObserver("content",function(b,f,d){f.content.removeArrayObserver(this._domController);d.content.addArrayObserver(this._domController)}))},_triggerRendering:function(){var b=this._domTree.childNodes,f,d=this.element.children.length,a=this._boundingIndex.start,h=this._boundingIndex.end;a+h-1>b.length&&(h=b.length-a);for(f=a;f<h;f++){var c=b[f].cloneNode(true);f>=d?this.element.appendChild(c):this.element.replaceChild(c,this.element.children[f])}for(f=d-1;f>=h-a;f--)this.element.removeChild(this.element.children[f])},
_domController:function(b,f,d){f.forEach(function(a,d){var c=b+d,f;c in this._replaceTree?(f=this._replaceTree[c],delete this._replaceTree[c],this._domTree.insertBefore(f.element,this._domTree.childNodes[b])):(f=Pa.View.create({tagName:"li"}),f._compiledTpl=this._childTemplate,f.controller=this.controller,f.content=a,this._domTree.insertBefore(f.render(),this._domTree.childNodes[b]),f._parentView=this);this._childViews.insertAt(c,f)},this);d.forEach(function(a){this._domTree.childNodes[b]?(a=this.content.content.indexOf(a),
a==-1?this._childViews[b].destroy(true):this._replaceTree[a]=this._childViews.removeAt(b)[0],this._domTree.removeChild(this._domTree.childNodes[b])):console.error("Collection trying to remove a dom node that does not exists",b,a)},this);f=f.length||d.length;b>this._boundingIndex.end-1||b+f<this._boundingIndex.start||Pa.renderLoop.schedule(this._triggerRendering,this)}})});PhoneApp.use("PhoneApp.types.Object");
PhoneApp.pack("PhoneApp",function(){var b=function(b,a,f){for(var b=b.children,c,g=0;g<b.length;g++){c=b[g];var e=a;c=c.style;c.webkitTransitionDuration=c.MozTransitionDuration=c.msTransitionDuration=c.OTransitionDuration=c.transitionDuration=f+"ms";c.MozTransform=c.webkitTransform="translate3d(0,"+e+"px,0)";c.msTransform=c.OTransform="translateX("+e+"px)"}},f=function(b){for(var a=b.scrollTop,f=b.children,c=function(){this.style.webkitTransition="-webkit-transform 0s ease-out";this.style.webkitTransform=
"translate3d(0,0,0)";b.scrollTop=0;this.removeEventListener("webkitTransitionEnd",c)},g=0;g<f.length;g++)f[g].style.webkitTransition="-webkit-transform 300ms ease-out",f[g].addEventListener("webkitTransitionEnd",c,false),f[g].style.webkitTransform="translate3d(0, "+a+"px,0)"};this.ScrollableView=this.View.extend({offsetPullToRefresh:50,isScrolling:false,isLoading:false,didInsertElement:function(){var d=this.element,a=d.querySelector(".pull-to-refresh");b(d,0,0);document.addEventListener("taptotop",
this.scrollToTop);this.$().on("touchmove",function(b){if(!(b.touches.length>1||b.scale&&b.scale!==1))return Pa.renderLoop.schedule(function(){var b=d.scrollTop;if(b>=0||this.isLoading)return true;b<=-this.offsetPullToRefresh?$(a).addClass("drop-to-refresh"):$(a).removeClass("drop-to-refresh");this.set("isActivated",true)},this),true}.bind(this));this.$().on("touchend",function(){if(!this.isActivated||this.isLoading)return true;Pa.renderLoop.schedule(function(){var f=d.scrollTop;if(f>=0)return true;
$(a).removeClass("drop-to-refresh");if(f>-this.offsetPullToRefresh)return true;a.style.webkitTransitionDuration=0;b(this.element,this.offsetPullToRefresh,200);$(a).addClass("loading");this.set("isActivated",false);this.set("isLoading",true);window.setTimeout(function(){this.set("isLoading",false);b(this.element,0,0);$(a).removeClass("loading")}.bind(this),2E3)},this)}.bind(this))},scrollToTop:function(){f(this.element)},willDestroyElement:function(){this.$().off();document.removeEventListener("taptotop",
this.scrollToTop)}})});
(function(){window.Swipe=function(b,f){if(!b)return null;this.options=f||{};this.speed=this.options.speed||300;this.callback=this.options.callback||function(){};this.foldedPosition=this.options.foldedPosition||85;this.activated=false;this.element=b;this.setup();this.element.addEventListener&&(this.element.addEventListener("touchstart",this,false),this.element.addEventListener("touchmove",this,false),this.element.addEventListener("touchend",this,false),this.element.addEventListener("touchcancel",this,
false),this.element.addEventListener("webkitTransitionEnd",this,false),this.element.addEventListener("msTransitionEnd",this,false),this.element.addEventListener("oTransitionEnd",this,false),this.element.addEventListener("transitionend",this,false),window.addEventListener("resize",this,false))};window.Swipe.prototype={setup:function(){this.width=Math.ceil("getBoundingClientRect"in this.element?this.element.getBoundingClientRect().width:this.element.offsetWidth);if(this.width===0&&typeof window.getComputedStyle===
"function")this.width=window.getComputedStyle(this.element,null).width.replace("px","");if(!this.width)return null;var b=this.element.style.visibility;this.element.style.visibility="hidden";var f=this.speed;this.speed=0;this.slide();this.speed=f;this.element.style.visibility=b},activate:function(b){this.activated=b;this.slide()},slide:function(){var b=this.element.style;b.webkitTransitionDuration=b.MozTransitionDuration=b.msTransitionDuration=b.OTransitionDuration=b.transitionDuration=this.speed+
"ms";var f=this.activated?0:this.foldedPosition*this.width/100;b.MozTransform=b.webkitTransform="translate3d("+f+"px,0,0)";b.msTransform=b.OTransform="translateX("+f+"px)"},handleEvent:function(b){switch(b.type){case "touchstart":this.onTouchStart(b);break;case "touchmove":this.onTouchMove(b);break;case "touchcancel":case "touchend":this.onTouchEnd(b);break;case "webkitTransitionEnd":case "msTransitionEnd":case "oTransitionEnd":case "transitionend":this.transitionEnd(b);break;case "resize":this.setup()}},
transitionEnd:function(b){this.callback(b)},onTouchStart:function(b){this.start={pageX:b.touches[0].pageX,pageY:b.touches[0].pageY,time:Number(new Date),position:this.activated?0:this.foldedPosition*this.width/100};this.isScrolling=void 0;this.direction=0;this.locked=void 0;this.deltaX=0;this.element.style.MozTransitionDuration=this.element.style.webkitTransitionDuration=0},onTouchMove:function(b){if(!(b.touches.length>1||b.scale&&b.scale!==1)){this.deltaX=b.touches[0].pageX-this.start.pageX+this.start.position;
if(this.direction===0)this.direction=b.touches[0].pageX-this.start.pageX<0?1:2;if(typeof this.isScrolling=="undefined")this.isScrolling=!!(this.isScrolling||Math.abs(this.deltaX)<Math.abs(b.touches[0].pageY-this.start.pageY));if(this.locked===void 0)this.locked=this.direction==1&&this.deltaX<0||this.direction==2&&this.deltaX>this.width;if(!this.isScrolling&&!this.locked){var f=this.deltaX*100/this.width;if(f<80&&!this.activated&&this.direction==1)this.activated=true;else if(f>20&&this.activated&&
this.direction==2)this.activated=false;if(f>-5&&f<this.foldedPosition+5)this.element.style.MozTransform=this.element.style.webkitTransform="translate3d("+(this.deltaX<0?0:this.deltaX)+"px,0,0)";b.stopPropagation();b.stopImmediatePropagation();b.preventDefault();return false}}},onTouchEnd:function(){this.locked=void 0;this.direction=0;(this.isScrolling=void 0)||this.slide()}}})();
(function(){Handlebars.registerHelper("action",function(b,f,d){var e;var c;var a=null;!d&&f.hash&&(d=f,f=this);if(typeof b=="string"){var a=b.split("."),h=a[0]||"";h==="view"?(a.shift(),b=this.view.get(a.join(".")),a.pop(),c=(a=a.join("."))?this.view.get(a):this.view,a=c):h=="controller"?(a.shift(),b=this.controller.get(a.join(".")),a.pop(),e=(a=a.join("."))?this.controller.get(a):this.controller,a=e):(b=Pa.get(b),a.pop(),a=Pa.get(a.join(".")))}return new Handlebars.SafeString(this.view._addAction(d.hash.on,
b,f,a))})})();(function(){Handlebars.registerHelper("bindAttr",function(b){var f=[];Object.keys(b.hash).forEach(function(d){f.push({attribute:d,value:b.hash[d]})});return new Handlebars.SafeString(this.view._addAttributeBindings(f))});Handlebars.registerHelper("bind",function(b){var b=b.split("."),f=b.pop(),b=this.view._addMetamorph(PhoneApp.get(b.join(".")),f);return new Handlebars.SafeString(b.renderWrapper())})})();
(function(){Handlebars.registerHelper("collection",function(b,f){if(arguments.length==1)f=b,b=Pa.CollectionView;var d={},a=null,a=this.view;if(!a.isView)throw Error("currentView is not a view :)");if(f.fn)d._childTemplate=f.fn;Object.keys(f.hash).forEach(function(a){d[a]=f.hash[a]});if(!d.controller)d.controller=this.controller;var h=b.create(d);a.appendChild(h);return new Handlebars.SafeString(h.renderWrapper().outerHTML)})})();
(function(){Handlebars.registerHelper("outlet",function(b,f){var d="view";typeof b=="string"&&(d=b);if(b.fn||f&&f.fn)throw Error("Outlet can not be a block");var a=null,a=this.view;if(!a.isView)throw Error("currentView is not a view :)");this.controller.set("view",null);d=a._addMetamorph(this.controller,d);return new Handlebars.SafeString(d.renderWrapper())})})();
(function(){Handlebars.registerHelper("view",function(b,f){if(!b)throw Error("Unknown view");var d={},a=null,a=this.view;if(!a.isView)throw Error("currentView is not a view :)");if(f.fn)d.template=f.fn;Object.keys(f.hash).forEach(function(a){d[a]=f.hash[a]});console.log("**** view overload",d);if(!d.controller)d.controller=this.controller;var h=b.create(d);a.appendChild(h);return new Handlebars.SafeString(h.renderWrapper().outerHTML)})})();
