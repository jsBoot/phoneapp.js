'use strict';(function(){this.Pa=this.Em=this.Ember=this.PhoneApp={K:function(){},TEMPLATES:Handlebars.templates||{},ENV:{HANDLEBARS_EXPOSE_OBJECTS:[]}}}).apply(this);
(function(a){var f=[],d,b=[],i,e=function(){d&&(f.push(d),d=null);if(i){if(!i.name)throw Error('NEED_A_NAME: Trying to bind "something" without any name');b.push(i);i=null}},h=function(c,b,e){b.split(".").forEach(function(a){if(!c||!(a in c))if(e)return c=void 0;else throw Error("MISSING: Trying to require something that doesn't exist"+b);c=c[a]});return c},g=function(c,b){var e={};b.split(".").forEach(function(b){e.o=c;e.k=b;b in c||(c[b]={});c=c[b]});return e},c=function(){e();var c=f,g=b;f=[];
b=[];var d={};g.forEach(function(c){if(c.name in d)throw Error("ALREADY_DEFINED: You are shadowing "+d[c.name]+" with "+c+" for name "+c.name);d[c.name]=c.value});c.forEach(function(c){if(c.name in d)throw Error("ALREADY_DEFINED: You are shadowing name "+c.name);d[c.name]=h(a,c.module,c.optional)});return d};this.use=function(c,b){e();d={module:c,name:c.split(".").pop(),optional:b};return this};this.add=function(c,b){if(c===void 0&&!b)throw Error("UNDEFINED: Requesting something local that is undefined");
e();i={value:c};return this};this.as=function(c){if(d)d.name=c;else if(i)i.name=c;e()};this.pack=function(b,e){var d=c(),i=g(a,b);(d=e.apply(i.o[i.k],[d]))&&(i.o[i.k]=d)};this.run=function(b){var e=c();b.apply({},[e])}}).apply(PhoneApp,[window]);
PhoneApp.pack("PhoneApp.types",function(){var a=0,f={};this.Object=function(){this.__class__="[PhoneApp.Object]"};this.Object.prototype.toString=function(){return this.__class__};var d=function(c,b,e){var a,g=true,d,h,n;e.__property__.forEach(function(k){var p=i(this,k)||i(window,k);if(p){h=p.shift();n=p.shift();var s=f[this.__id__];h.addObserver(n,function(i,f,p){d=[void 0,h,n,p];if(s[b]){var k=a,q=e.apply(c,d);k!=q&&(a=q,s[b].forEach(function(e){window.setTimeout(function(){e.collapse&&c[b]!==q||
e.apply(c,[b,k,q])},1)}))}else g=true})}else console.error("Trying to property non-existent",k)},c);Object.defineProperty(c,b,{enumerable:true,configurable:true,get:function(){g&&(g=false,d||(d=[void 0,h,n,h&&h[n]]),a=e.apply(this,d));return a},set:function(c){d?d[0]=c:d=[c,h,n];a=e.apply(this,d);d[0]=void 0;return a}})},b=/[A-Za-z0-9]Binding$/;this.Object.create=this.Object.prototype.create=function(c){c=new (this.extend(c));f[c.__id__=a++]={};var e=[],g;for(g in c)e.push(g);e.forEach(function(c){var e=
this[c];e&&(b.test(c)?(PhoneApp.Binding.bind(this,c.substr(0,c.length-7),e),this.hasOwnProperty(c)?delete this[c]:delete Object.getPrototypeOf(this)[c]):(e.hasOwnProperty("__observes__")&&e.__observes__.forEach(function(c){var b=i(this,c)||i(window,c);if(b){var a=b.shift(),g=b.shift();if(!("addObserver"in a))throw Error("NOT_OBSERVABLE: "+a);a.addObserver(g,function(){e.apply(a,[a,g])})}else console.error("Trying to observe non existent",c)},this),e.hasOwnProperty("__property__")&&d(this,c,e)))},
c);c.init();return c};this.Object._super=this.Object.prototype._super=function(c,b,e){return this.prototype[c].apply(b||this,e)};this.Object.extend=this.Object.prototype.extend=function(c){var c=c||{},b;b=c.constructor!=Function?function(){Object.keys(c).forEach(function(b){this[b]=c[b]},this)}:c;b.prototype=new this;b.extend=this.extend;b.create=this.create;b._super=this._super;return b};this.Object.prototype.init=function(){};this.Object.prototype.addObserver=function(c,b,e){c in f[this.__id__]||
(f[this.__id__][c]=[]);c=f[this.__id__][c];if(c.indexOf(b)==-1)b.collapse=e===void 0||e,c.push(b)};this.Object.prototype.removeObserver=function(c,b){if(c in f[this.__id__]){var e=f[this.__id__][c],a=e.indexOf(b);a!=-1&&e.splice(a,1)}};this.Object.prototype.set=function(c,b){var a=e(this,c),g=a.shift(),c=a.shift(),d=g[c];b!==d&&(g[c]=b,(f[g.__id__][c]||[]).forEach(function(e){window.setTimeout(function(){e.collapse&&g[c]!==b||e.apply(g,[c,d,b])},1)}))};this.Object.prototype.destroy=function(){delete f[this.__id__];
for(var c in this)delete this[c]};this.Object.isExtensionOf=function(c,b){return c&&c.prototype&&c.prototype instanceof b};var i=function(c,b){for(var e=b.split(".");c&&e.length>1;)c=c[e.shift()];c&&!(e[e.length-1]in c)&&(c=null);return c?[c,e.shift()]:void 0},e=function(c,b){for(var e=b.split("."),a;e.length>1;)a=e.shift(),a in c||(c[a]={}),c=c[a];return[c,e.shift()]};PhoneApp.get=this.Object.prototype.get=function(c){(c=i(this,c)||i(window,c))&&(c=c.shift()[c.pop()]);return c};var h,g;PhoneApp.Binding=
{oneWay:function(c){return function(c,b,e,a){return a}.property(c)},bothWays:function(c){return function(c,b,e,a){if(c===void 0)return a;b.set(e,c);return c}.property(c)},from:function(c){h=c;return this},to:function(c){g=c;return this},connect:function(c){this.bind(c,g,h);g=h=void 0},bind:function(c,b,e){d(c,b,this.bothWays(e))}};Function.prototype.observes=function(){this.__observes__=Array.prototype.slice.call(arguments);return this};Function.prototype.property=function(){this.__property__=Array.prototype.slice.call(arguments);
return this}});PhoneApp.use("PhoneApp.types.Object");
PhoneApp.pack("PhoneApp.types",function(a){Array.prototype.replace=function(b,a,e){var d;e===void 0&&(e=[]);if(!e||e.constructor!=Array)e=[e];d=e.map(function(c){return c});d.unshift(a);d.unshift(b);var g=Array.prototype.splice.apply(this,d);"__hashcache__"in this&&this.__hashcache__.forEach(function(c){window.setTimeout(function(){c.apply(this,[b,e,g])}.bind(this),1)},this);return g};Array.prototype.popObject=function(){return this.replace(this.length-1,1)};Array.prototype.pushObject=function(b){return this.replace(this.length,
0,b)};Array.prototype.shiftObject=function(){return this.replace(0,1)};Array.prototype.unshiftObject=function(b){return this.replace(0,0,b)};Array.prototype.removeObject=function(b){b=this.indexOf(b);if(b!=-1)return this.replace(b,1)};Array.prototype.insertAt=function(b,a){return this.replace(b,0,a)};Array.prototype.removeAt=function(b){return this.replace(b,1)};Array.prototype.clear=function(){return this.replace(0,this.length)};Array.prototype.removeArrayObserver=function(b){"__hashcache__"in this&&
(b=this.__hashcache__.indexOf(b),b!=-1&&this.__hashcache__.splice(b,1))};Array.prototype.addArrayObserver=function(b){if(!("__hashcache__"in this))this.__hashcache__=[];this.__hashcache__.push(b)};var f=function(b,a,e){if(a!=e){var d=b[a],d=b.replace(e,1,d);b.replace(a,1,d)}},d=function(b,a,e,h){if(!(e>=h)){f(b,e,Math.floor((e+h)/2));var g,c=e;for(g=e+1;g<=h;g++)a(b[g],b[e])<0&&f(b,++c,g);f(b,e,c);d(b,a,e,c-1);d(b,a,c+1,h)}};Array.prototype.quickSort=function(b){d(this,b,0,this.length-1);return this};
this.ArrayController=a.Object.extend({length:0,init:function(){a.Object._super("init",this);var b=false,d=false,e=false,h=false,g=[],c=function(){return true},f=function(c){return c},o=function(c,b){return c<b?-1:c==b?0:1},j=Infinity,l=function(b,a,k){k.forEach(function(c){c=d.indexOf(c,b);c!=-1&&(d.splice(c,1),c=e.splice(c,1).pop(),c=h.indexOf(c),h.splice(c,1),c<g.length&&g.replace(c,1))});a.forEach(function(a){if(c(a)){d.splice(b,0,a);a=f(a);e.splice(b,0,a);var k=0;h.some(function(c,b){o(a,c)>=
0&&(k=b+1);return o(a,c)<0});h.splice(k,0,a);k<=g.length&&k<j&&g.replace(k,0,a)}});g.length>j&&g.replace(j,g.length-j);j!=Infinity&&g.length<j&&g.length<h.length&&g.replace(g.length,0,h.slice(g.length,j));this.set("length",g.length)}.bind(this);this.destroy=function(){b.removeArrayObserver(l);h=e=d=b=false;this.set("length",0);g.clear()};Object.defineProperty(this,"original",{get:function(){return b}});var m=false;if(this.sort!==void 0)o=this.sort;if(this.filter!==void 0)c=this.filter;if(this.map!==
void 0)f=this.map;if(this.limit!==void 0)j=this.limit;if(this.content!==void 0)b=this.content,m=true;Object.defineProperty(this,"content",{enumerable:true,get:function(){return g},set:function(a){b&&b.removeArrayObserver(l);b=a;b.addArrayObserver(l);d=b.filter(c);e=d.map(f);h=Array.from(e);h.quickSort(o);g.clear();h.some(function(c){g.pushObject(c);return g.length==j});this.set("length",g.length)}});Object.defineProperty(this,"filter",{get:function(){return c},set:function(a){c=a;b&&(d=b.filter(c),
e=d.map(f),h=Array.from(e),h.quickSort(o),g.clear(),h.some(function(c){g.pushObject(c);return g.length==j}),this.set("length",g.length))}});Object.defineProperty(this,"map",{get:function(){return f},set:function(c){f=c;b&&(e=d.map(f),h=Array.from(e),h.quickSort(o),g.clear(),h.some(function(c){g.pushObject(c);return g.length==j}),this.set("length",g.length))}});Object.defineProperty(this,"sort",{get:function(){return o},set:function(c){o=c;b&&(h.quickSort(o),g.clear(),h.some(function(c){g.pushObject(c);
return g.length==j}),this.set("length",g.length))}});Object.defineProperty(this,"limit",{get:function(){return j},set:function(c){j=c;b&&(g.length>j?g.replace(j,g.length-j):g.replace.apply(g,[g.length,0,h.slice(g.length,j)]),this.set("length",g.length))}});if(m)this.content=b}})});PhoneApp.add(Error).as("NativeError");
PhoneApp.pack("PhoneApp.types",function(a){this.Error=function(f,d){var b=a.NativeError.apply(this,[d]);if(!(this==window||this===void 0))if(this.message=b.message,this.stack=b.stack,this.name=f,!this.stack)this.stack=printStackTrace()};Object.getOwnPropertyNames(a.NativeError.prototype).forEach(function(f){f!="constructor"&&(this.Error.prototype[f]=a.NativeError.prototype[f])},this);"NOT_IMPLEMENTED,UNSPECIFIED,NOT_INITIALIZED,WRONG_ARGUMENTS,UNSUPPORTED,NATURAL_BORN_CRASH".split(",").forEach(function(a,
d){this.Error[a]=this.Error.prototype[a]=d},this);this.Error.prototype.toString=function(){return this.name+": "+this.message+"\nStack: "+(typeof this.stack=="array"?this.stack.join("\n"):this.stack)}});PhoneApp.use("PhoneApp.types.Error");
PhoneApp.pack("PhoneApp.service",function(a){this.Error=function(f,d,b){a.Error.apply(this,arguments);this.details=b};this.Error.prototype=Object.create(a.Error.prototype);"OPENING_FAILED,SEND_FAILED,FAILED_UID,MEANINGLESS_DATA,BAD_REQUEST,MISSING,BAD_REQUEST,UNAUTHORIZED,INVALID_SIGNATURE,WRONG_CREDENTIALS,SHOULD_NOT_HAPPEN,SERVICE_UNAVAILABLE,UNAUTHORIZED,UNSPECIFIED".split(",").forEach(function(a){this[a]=this.prototype[a]=a},this.Error)});PhoneApp.add(XMLHttpRequest).as("XMLHttpRequest");PhoneApp.use("PhoneApp.service.Error");
PhoneApp.pack("PhoneApp.service",function(a){var f=typeof File!="undefined"&&typeof Blob!="undefined";this.SimpleClient=function(){var b,d="",e="",h="",g=a.XMLHttpRequest;this.configure=function(c){if(c.host)b=c.host;if(c.port)d=c.port;c.scheme&&(h=c.scheme+":");if(c.version)e=c.version;if(c.backend)g=c.backend};Object.defineProperty(this,"Backend",{get:function(){return g}});this.url=function(c){var a=h+"//"+b+(d?":"+d:"")+(e?"/"+e:"");c.service&&(a+="/"+c.service);c.id&&(a+="/"+encodeURIComponent(c.id));
c.command&&(a+="/"+c.command);c.additional&&(a+="/"+c.additional.map(encodeURIComponent).join("/"));if(!c.params)c.params={};var g=[];Object.keys(c.params).forEach(function(b){g.push(encodeURIComponent(b)+"="+encodeURIComponent(c.params[b]))});g.length&&(a+="?"+g.join("&"));return a}};var d=function(){var b=this.inner,d=this.options.onfailure,e=this.options.onsuccess;if(b)if(b.readyState==b.FAILED_OPENING)this.inner=this.engine=this.options.onsuccess=this.options.onfailure=b.onreadystatechange=null,
this.error=new a.Error(a.Error.UNAUTHORIZED,"Not authorized to access this",this),d&&d(this.error);else{if(b.readyState==b.DONE){var h=this.engine;this.inner=this.engine=this.options.onsuccess=this.options.onfailure=b.onreadystatechange=null;try{if(b.responseText)this.data=JSON.parse(b.responseText)}catch(g){try{this.data=(new DOMParser).parseFromString(b.responseText,"application/xml")}catch(c){this.data=b.responseText,this.error=new a.Error(a.Error.MEANINGLESS_DATA,"WHAT? ALBATROS?",this)}}switch(b.status){case 200:case 201:break;
case 308:this.options.url=b.getResponseHeader("Location");h.query(h.GET,this.options,this.headers);return;case 400:this.error=new a.Error(a.Error.BAD_REQUEST,"Bad request!",this);break;case 401:this.error=b.getResponseHeader("WWW-Authenticate")?new a.Error(a.Error.WRONG_CREDENTIALS,"Wrong street cred",this):new a.Error(a.Error.INVALID_SIGNATURE,"Invalid singing",this);break;case 402:case 403:case 405:case 501:this.error=new a.Error(a.Error.UNAUTHORIZED,"Not authorized to access this",this);break;
case 404:this.error=new a.Error(a.Error.MISSING,"Missing resource",this);break;case 406:case 411:case 412:case 413:case 414:case 415:case 416:case 417:this.error=new a.Error(a.Error.SHOULD_NOT_HAPPEN,"Should never happen",this);break;case 500:case 503:this.error=new a.Error(a.Error.SERVICE_UNAVAILABLE,"Server is down",this);break;case 0:this.error=new a.Error(a.Error.UNAUTHORIZED,"Not authorized to access this",this);break;default:this.error=new a.Error(a.Error.UNSPECIFIED,"WTF?",this)}if(this.error)throw d&&
d(this.error),this.error;e&&e(this.data)}}else console.warn("BAD SHIT HAPPENED!")};this.SimpleClient.prototype.query=function(b,i,e){var h=new this.Backend,b=b||this.GET,g=i.url||this.url(i);e||(e={});if(!e.Accept)e.Accept="application/json";var c={options:i,method:b,headers:e,error:null,data:{},exception:null};h.onreadystatechange=d.bind(c);try{h.open(b,g,true)}catch(t){c.exception=t.toString();c.error=new a.Error(a.Error.OPENING_FAILED,"Failed opening likely bogus request",c);if(i.onfailure)i.onfailure(c.error);
throw c.error;}g=i.payload;if(b==this.POST&&(e["Content-Type"]||(e["Content-Type"]=f&&(g instanceof File||g instanceof Blob)?g.type:"application/json"),e["Content-Type"]=="application/json"))try{g=JSON.stringify(g)}catch(o){e["Content-Type"]="application/octet-stream"}Object.keys(e).forEach(function(c){h.setRequestHeader(c,e[c])});try{h.send(g)}catch(j){c.exception=j.toString();c.error=new a.Error(a.Error.SEND_FAILED,"Failed sending. Bogus payload?",c);if(i.onfailure)i.onfailure(c.error);throw c.error;
}c.inner=h;c.engine=this};this.SimpleClient.HEAD=this.SimpleClient.prototype.HEAD="HEAD";this.SimpleClient.GET=this.SimpleClient.prototype.GET="GET";this.SimpleClient.POST=this.SimpleClient.prototype.POST="POST";this.SimpleClient.PATCH=this.SimpleClient.prototype.PATCH="PATCH";this.SimpleClient.PUT=this.SimpleClient.prototype.PUT="PUT";this.SimpleClient.DELETE=this.SimpleClient.prototype.DELETE="DELETE"});
PhoneApp.pack("PhoneApp",function(){this.Run=function(a,b){var f=null;this.start=function(){f=window.setInterval(b,a)};this.stop=function(){window.clearInterval(f)}};var a=[],f=[];this.renderLoop={add:function(d,b,f){a.push({view:d,operation:b,callback:f})},schedule:function(d,b,f){a.push({view:b,operation:"schedule",callback:d,extra:f})},hook:function(a){f.indexOf(a)==-1&&f.push(a)}};(function(a,b){var f,e=Date.now(),h=function(g){f!==false&&(requestAnimationFrame(h,b),f=a(g-e,g),e=g)};h()})(function(d){if(!(d>
160)){for(var d=a.shift(),b,i=[];d;){b=d.view;if(d.operation=="schedule")d.callback.apply(b,d.extra);else{var e=document.getElementById(b.elementId);if(d.operation=="render"){if(!e){i.push(d);d=a.shift();continue}b.render(e)}else d.operation=="destroy"&&e&&b.element.parentNode.removeChild(b.element);d.callback&&d.callback.call(b,d.operation)}d=a.shift()}f.forEach(function(b){b()});a=i;return true}})});
PhoneApp.pack("PhoneApp.types",function(){var a={};String.prototype.dasherize=function(){return!this.length?"":a[this]||(a[this]=this.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase())};String.prototype.replaceAt=function(a,d){return this.substr(0,a)+d+this.substr(a+d.length)}});PhoneApp.use("PhoneApp.types.Object");
PhoneApp.pack("PhoneApp",function(a){this.Application=a.Object.extend({rootElement:$("body").get(0),ready:PhoneApp.K,autoHideSplash:false,device:a.Object.create({states:{BACKGROUND:"background",RUNNING:"running"},state:null,isIphone:false,isIpad:false,isRetina:false,isAndroid:false,isMobile:function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)}.property()}),network:a.Object.create({types:window.Connection||{},states:{ONLINE:"online",OFFLINE:"offline"},type:null,state:null}),
hideSplash:function(){this.device.isMobile&&navigator.splashscreen.hide&&navigator.splashscreen.hide()},onDeviceReady:function(){var a;$(this.rootElement).empty();this.rootView.controller=this.rootController;this.rootView.appendTo(this.rootElement);window.devicePixelRatio>1&&this.device.set("isRetina",true);this.device.isMobile&&(window.KeyboardToolbarRemover&&cordova.require("cordova/plugin/keyboard_toolbar_remover").hide(),this.autoHideSplash&&this.hideSplash(),window.device&&(a=window.device.platform.toLowerCase(),
a.indexOf("iphone")!==-1?this.device.set("isIphone",true):a.indexOf("ipad")!==-1?this.device.set("isIpad",true):a.indexOf("android")!=-1&&this.device.set("isAndroid",true),(new PhoneApp.Run(1E3,function(){navigator.connection.type==window.Connection.NONE&&this.network.set("state",this.network.states.OFFLINE);navigator.connection.type!=this.networkType&&this.network.set("type",navigator.connection.type)}.bind(this))).start()));this.router.transitionTo("index")},bindPhoneGapEvents:function(){document.addEventListener("deviceready",
function(){this.onDeviceReady();this.ready()}.bind(this),false);document.addEventListener("pause",function(){this.device.set("state",this.device.states.BACKGROUND);this.onPause()}.bind(this),false);document.addEventListener("resume",function(){this.device.set("state",this.device.states.RUNNING);this.onResume()}.bind(this),false);document.addEventListener("online",function(){this.network.set("state",this.network.states.ONLINE)}.bind(this),false);document.addEventListener("offline",function(){this.network.set("state",
this.network.states.OFFLINE)}.bind(this),false)},initialize:function(){if(this.device.isMobile)this.bindPhoneGapEvents();else this.onDeviceReady()}})});PhoneApp.use("PhoneApp.types.Object");
PhoneApp.pack("PhoneApp",function(a){var f=function(a,b){var i=a.split("."),e=[];Object.keys(i).forEach(function(h){var g=i[h];if(!(h==i.length-1&&g=="index"))if(g in b)b=b[g],e.push({path:g,route:b});else throw Error("unknown path "+a);});b.index&&b.index.redirectsTo&&e.push.apply(e,f(b.index.redirectsTo,b));return e};this.Route=a.Object.extend({_childs:{},route:null,enter:PhoneApp.K,redirectsTo:null,connectOutlets:PhoneApp.K,parentRoot:null,init:function(){Pa.Route._super("init",this);for(var d in this)if(a.Object.isExtensionOf(this[d],
Pa.Route))this[d]=this[d].create(),this[d].parentRoot=this,this._childs[d]=this[d]},toString:function(){return"PhoneApp.Route"}});this.Router=a.Object.extend({enableLogging:false,root:PhoneApp.Route,currentPath:null,controllers:{},init:function(){Pa.Router._super("init",this);this.root=this.root.create()}});this.Router.toString=this.Router.prototype.toString=function(){return"PhoneApp.Router"};this.Router.prototype.transitionTo=function(a,b){var i=f(a,this.root),e=i.length-1,h="root";i.forEach(function(a,
c){h+="."+a.path;a.route.enter(this,b);c==e&&(this.set("currentPath",h),a.route.connectOutlets(this,b))},this)}});PhoneApp.use("PhoneApp.types.Object");PhoneApp.pack("PhoneApp",function(a){this.Controller=a.Object.extend({isController:true,content:null,connectOutlet:function(a){var d=a.viewClass,b=a.controller||this,i=a.context||null,a=a.outletName||"view";b&&i&&b.set("content",i);d=d.create();d.set("controller",b);this.set(a,d)},removeOutlet:function(a){this.set(a,null)}})});
PhoneApp.pack("PhoneApp",function(){var a=0;this.Metamorph=function(f,d,b){this.id=++a;this.startNodeId="metamorph-"+this.id+"-start";this.endNodeId="metamorph-"+this.id+"-end";var i=function(a,b,d){var a=document.getElementById(this.startNodeId),c=document.getElementById(this.endNodeId);if(!a||!c)throw Error("Miss Metamorph hooks");var i=a.nextSibling;PhoneApp.renderLoop.schedule(function(){if(d.isView){var a=d?d.render():document.createTextNode("");if(d)d._parentView=f,f._childViews.push(d),d.willInsertElement();
i==c?c.parentNode.insertBefore(a,c):i.parentNode.replaceChild(a,i);d&&d.didInsertElement();b&&b.isView&&b.destroy()}else i==c?c.parentNode.insertBefore(c,document.createTextNode(d||"")):i.textContent=d||""})}.bind(this);d.addObserver(b,i);this.renderWrapper=function(){return'<script id="'+this.startNodeId+'"><\/script>'+(d.get(b)||" ")+'<script id="'+this.endNodeId+'"><\/script>'};this.destroy=function(){d.removeObserver(b,i)}}});PhoneApp.use("PhoneApp.types.Object");
PhoneApp.pack("PhoneApp",function(a){var f=0,d=0,b=function(a){var a=a.split(":"),b=a[0],d="",c,f,i=b.split("."),j=i.pop(),i=i.join(".");a.length>1&&(c=a[1],a.length===3&&(f=a[2]),d=":"+c,f&&(d+=":"+f));return{path:b,property:j,parent:i,classNames:d,className:c===""?void 0:c,falsyClassName:f}},i=function(a,b,d){a&&(d?a.setAttribute(b,d):a.removeAttribute(b))};this.View=a.Object.extend({template:null,templateName:null,controller:null,classNames:null,attributeBindings:null,classNameBindings:null,willInsertElement:PhoneApp.K,
didInsertElement:PhoneApp.K,willDestroyElement:PhoneApp.K,isView:true,tagName:"div",element:null,elementId:null,_parentView:null,_childViews:null,_compiledTpl:null,_isDestroying:false,_meta_observers:null,_metamorphs:null,init:function(){PhoneApp.View._super("init",this);this.elementId="phoneapp"+this.__id__;PhoneApp.View.views[this.elementId]=this;this._childViews=[];if(!this.attributeBindings)this.attributeBindings=[];if(this.classNameBindings){if(typeof this.classNameBindings=="string")this.classNameBindings=
this.classNameBindings.split(/\s+/)}else this.classNameBindings=[];if(this.classNames){if(typeof this.classNames=="string")this.classNames=this.classNames.split(" ")}else this.classNames=[];this._meta_observers=[];this._metamorphs=[];var a=null;if(this.template)a=this.template;else if(this.templateName&&(a=PhoneApp.TEMPLATES[this.templateName],!a))throw Error("unknown template : "+this.templateName);this._compiledTpl=a||PhoneApp.K},context:function(){var a=this.controller;if(!a&&this._parentView&&
this._parentView.controller)a=this._parentView.controller;var b={};PhoneApp.ENV.HANDLEBARS_EXPOSE_OBJECTS.forEach(function(a){b[a]=window[a]});b.controller=a;b.view=this;return b}.property("controller"),$:function(a){return a?$(this.element).find(a):$(this.element)},appendTo:function(a){this.willInsertElement();var b=this.render();$(b).appendTo(a);this.didInsertElement()},insertChildAt:function(a,b){this.willInsertElement();PhoneApp.renderLoop.schedule(function(){this.element.insertBefore(a.element||
a.render(),this.element.children[b]);a.didInsertElement()},this);a._parentView=this;this._childViews.push(a);return a},appendChild:function(a){a.willInsertElement();PhoneApp.renderLoop.add(a,"render",function(){this.didInsertElement()});a._parentView=this;this._childViews.push(a);return a},rerender:function(){this._metamorphs.forEach(function(a){a.destroy()});return Pa.renderLoop.schedule(function(){this.render(this.element)},this)},renderWrapper:function(){var a=[],b="",d;this.attributeBindings.forEach(function(c){var b=
c;c.indexOf(":")>-1&&(c=c.split(":"),b=c.pop(),c=c.pop());a.push({attribute:c,value:b})},this);b=this.classNames.join(" ");this.classNameBindings&&a.push({attribute:"class",value:this.classNameBindings});a=this._computeAttributesBindings(a);b&&(a["class"]+=" "+b);d=document.createElement(this.tagName);Object.keys(a).forEach(function(c){a[c]&&d.setAttribute(c,a[c])});d.setAttribute("id",this.elementId);return d},render:function(a){if(this._isDestroying)throw Error("Trying to render a destroyed view");
a||(a=this.renderWrapper());this.element=a;this.element.innerHTML=this._compiledTpl(this.context)||"";return this.element},_computeAttributesBindings:function(a,d){var g={"class":"",style:""},c=this;a.forEach(function(a){var e=a.attribute,a=a.value,f=d?'[data-phoneapp-binding="'+d+'"]':null,l;if(e=="class")typeof a=="string"&&(a=a.split(/\s+/)),a.forEach(function(a){var d=b(a);if(d.parent.indexOf("view")===0)d.parent=d.parent.replace("view.",""),d.path=d.path.replace("view.",""),a=d.path;!d.path&&
d.className?g["class"]+=" "+d.className:(d.parent=d.parent?this.get(d.parent):this,a=function(a,b,e,h){if(!c._isDestroying){!l&&!h&&(l=!f?c.element:c.element.querySelector(f));l&&(g["class"]=l.getAttribute("class")||"");a=typeof e;if(a=="boolean"||a=="number"){if(!d.className)d.className=d.property.dasherize();g["class"]=g["class"].replace(d.className,"").replace(d.falsyClassName,"");e?g["class"]+=" "+d.className:d.falsyClassName&&(g["class"]+=" "+d.falsyClassName)}else a=="string"&&(g["class"]=g["class"].replace(b,
e));h||Pa.renderLoop.schedule(i,c,[l,"class",g["class"]])}},a(d.property,"",this.get(d.path),true),this._meta_observers.push({parent:d.parent,property:d.property,callback:a}),d.parent.addObserver(d.property,a))},this);else if(e=="style")typeof a=="string"&&(a=a.split(/\s+/)),a.forEach(function(a){var d=b(a);d.styleName=d.className;d.styleValue=d.falsyClassName;d.isBinding=d.styleValue.indexOf("{{this}}")!=-1;!d.path&&!d.isBinding?g.style+=" "+d.styleName+":"+d.styleValue:(d.parent=d.parent?this.get(d.parent):
this,a=function(a,b,e,h){if(!c._isDestroying){!l&&!h&&(l=!f?c.element:c.element.querySelector(f));if(l)g.style=l.getAttribute("style");var k={};(g.style||"").split(";").forEach(function(a){a&&(a=a.split(":"),k[a.shift().trim()]=a.shift())});e?k[d.styleName.trim()]=d.styleValue.replace("{{this}}",e):delete k[d.styleName.trim()];g.style="";Object.keys(k).forEach(function(a){g.style+=a+":"+k[a]+";"});h||Pa.renderLoop.schedule(i,c,[l,"style",g.style])}},a(d.property,"",this.get(d.path),true),this._meta_observers.push({parent:d.parent,
property:d.property,callback:a}),d.parent.addObserver(d.property,a))},this);else{var m=a.split("."),r=m.pop(),m=m.join("."),n;m.indexOf("view")===0&&(m=m.replace("view.",""),a=a.replace("view.",""));m=m?this.get(m):this;n=function(a,b,d,h){!c._isDestroying&&g[e]!=d&&(g[e]=d,h||(l||(l=!f?c.element:c.element.querySelector(f)),Pa.renderLoop.schedule(i,c,[l,e,g[e]])))};n(r,"",this.get(a),true);this._meta_observers.push({parent:m,property:r,callback:n});m.addObserver(r,n)}},this);return g},_addAction:function(a,
b,g,c){var f=++d;$(this.element).on(a,'[data-phoneapp-action="'+f+'"]',function(a){a.context=g;b.call(c,a)}.bind(this));return"data-phoneapp-action="+f},_addAttributeBindings:function(a){var b=++f,d;d=this._computeAttributesBindings(a,b);var c="data-phoneapp-binding="+b;Object.keys(d).forEach(function(a){d[a]&&(c+=" "+a+'="'+d[a]+'"')});return c},_addMetamorph:function(a,b){var d=new PhoneApp.Metamorph(this,a,b);this._metamorphs.push(d);return d},destroy:function(){this.willDestroyElement();this._isDestroying=
true;this._meta_observers.forEach(function(a){a.parent.removeObserver(a.property,a.callback)});this._metamorphs.forEach(function(a){a.destroy()});this._parentView&&!this._parentView._isDestroying&&this._parentView._childViews.removeObject(this);this.$().off();this._parentView&&this._parentView._isDestroying?this._destroyElement():PhoneApp.renderLoop.add(this,"destroy",this._destroyElement)},_destroyElement:function(){delete PhoneApp.View.views[this.elementId];this._childViews.forEach(function(a){a.destroy()});
PhoneApp.View._super("destroy",this)}});this.View.views={}});PhoneApp.use("PhoneApp.types.Object");
PhoneApp.pack("PhoneApp",function(){this.CollectionView=this.View.extend({content:null,itemViewClass:Pa.View,_childTemplate:null,_domTree:null,_replaceTree:null,init:function(){PhoneApp.CollectionView._super("init",this);this._replaceTree={}},didInsertElement:function(){this.content&&(this.content.content.length&&this._domController(0,this.content.content,[]),this.content.content.addArrayObserver(this._domController.bind(this)),this.addObserver("content",function(a,f,d){f.content.removeArrayObserver(this._domController);
d.content.addArrayObserver(this._domController)}))},_domController:function(a,f,d){var b=this.element.children;f.forEach(function(b,d){var f=a+d,g;f in this._replaceTree?(g=this._replaceTree[f],delete this._replaceTree[f]):(g=this.itemViewClass.create({tagName:"li"}),g._compiledTpl=this._childTemplate,g.controller=this.controller,g.content=b);this.insertChildAt(g,a)},this);d.forEach(function(d){b[a]?(d=this.content.content.indexOf(d),d==-1?this._childViews[a].destroy():this._replaceTree[d]=this._childViews.removeAt(a)[0]):
console.error("Collection trying to remove a dom node that does not exists",a,d)},this)}})});PhoneApp.use("PhoneApp.types.Object");
PhoneApp.pack("PhoneApp",function(){var a=function(a,b,f){for(var a=a.children,e,h=0;h<a.length;h++){e=a[h];var g=b;e=e.style;e.webkitTransitionDuration=e.MozTransitionDuration=e.msTransitionDuration=e.OTransitionDuration=e.transitionDuration=f+"ms";e.MozTransform=e.webkitTransform="translate3d(0,"+g+"px,0)";e.msTransform=e.OTransform="translateX("+g+"px)"}},f=function(a){for(var b=a.scrollTop,f=a.children,e=function(){this.style.webkitTransition="-webkit-transform 0s ease-out";this.style.webkitTransform=
"translate3d(0,0,0)";a.scrollTop=0;this.removeEventListener("webkitTransitionEnd",e)},h=0;h<f.length;h++)f[h].style.webkitTransition="-webkit-transform 300ms ease-out",f[h].addEventListener("webkitTransitionEnd",e,false),f[h].style.webkitTransform="translate3d(0, "+b+"px,0)"};this.ScrollableView=this.View.extend({offsetPullToRefresh:50,isScrolling:false,isLoading:false,didInsertElement:function(){var d=this.element,b=d.querySelector(".pull-to-refresh");a(d,0,0);document.addEventListener("taptotop",
this.scrollToTop);this.$().on("touchmove",function(a){if(!(a.touches.length>1||a.scale&&a.scale!==1))return Pa.renderLoop.schedule(function(){var a=d.scrollTop;if(a>=0||this.isLoading)return true;a<=-this.offsetPullToRefresh?$(b).addClass("drop-to-refresh"):$(b).removeClass("drop-to-refresh");this.set("isActivated",true)},this),true}.bind(this));this.$().on("touchend",function(){if(!this.isActivated||this.isLoading)return true;Pa.renderLoop.schedule(function(){var f=d.scrollTop;if(f>=0)return true;
$(b).removeClass("drop-to-refresh");if(f>-this.offsetPullToRefresh)return true;b.style.webkitTransitionDuration=0;a(this.element,this.offsetPullToRefresh,200);$(b).addClass("loading");this.set("isActivated",false);this.set("isLoading",true);window.setTimeout(function(){this.set("isLoading",false);a(this.element,0,0);$(b).removeClass("loading")}.bind(this),2E3)},this)}.bind(this))},scrollToTop:function(){f(this.element)},willDestroyElement:function(){this.$().off();document.removeEventListener("taptotop",
this.scrollToTop)}})});
(function(){window.Swipe=function(a,f){if(!a)return null;this.options=f||{};this.speed=this.options.speed||300;this.callback=this.options.callback||function(){};this.foldedPosition=this.options.foldedPosition||85;this.isSliding=this.activated=false;this.element=a;this.setup();this.element.addEventListener&&(this.element.addEventListener("touchstart",this,false),this.element.addEventListener("touchmove",this,false),this.element.addEventListener("touchend",this,false),this.element.addEventListener("touchcancel",this,
false),this.element.addEventListener("webkitTransitionEnd",this,false),this.element.addEventListener("msTransitionEnd",this,false),this.element.addEventListener("oTransitionEnd",this,false),this.element.addEventListener("transitionend",this,false),window.addEventListener("resize",this,false))};window.Swipe.prototype={setup:function(){this.width=Math.ceil("getBoundingClientRect"in this.element?this.element.getBoundingClientRect().width:this.element.offsetWidth);if(this.width===0&&typeof window.getComputedStyle===
"function")this.width=window.getComputedStyle(this.element,null).width.replace("px","");if(!this.width)return null;var a=this.element.style.visibility;this.element.style.visibility="hidden";var f=this.speed;this.speed=0;this.slide();this.speed=f;this.element.style.visibility=a},activate:function(a){this.activated=a;this.slide()},slide:function(){var a=this.element.style;a.webkitTransitionDuration=a.MozTransitionDuration=a.msTransitionDuration=a.OTransitionDuration=a.transitionDuration=this.speed+
"ms";var f=this.activated?0:this.foldedPosition*this.width/100;a.MozTransform=a.webkitTransform="translate3d("+f+"px,0,0)";a.msTransform=a.OTransform="translateX("+f+"px)"},handleEvent:function(a){switch(a.type){case "touchstart":this.onTouchStart(a);break;case "touchmove":this.onTouchMove(a);break;case "touchcancel":case "touchend":this.onTouchEnd(a);break;case "webkitTransitionEnd":case "msTransitionEnd":case "oTransitionEnd":case "transitionend":this.transitionEnd(a);break;case "resize":this.setup()}},
transitionEnd:function(a){this.callback(a)},onTouchStart:function(a){this.start={pageX:a.touches[0].pageX,pageY:a.touches[0].pageY,time:Number(new Date),position:this.activated?0:this.foldedPosition*this.width/100};this.isScrolling=void 0;this.direction=0;this.locked=void 0;this.deltaX=0;this.element.style.MozTransitionDuration=this.element.style.webkitTransitionDuration=0},onTouchMove:function(a){if(!(a.touches.length>1||a.scale&&a.scale!==1)){this.deltaX=a.touches[0].pageX-this.start.pageX+this.start.position;
if(this.direction===0)this.direction=a.touches[0].pageX-this.start.pageX<0?1:2;if(typeof this.isScrolling=="undefined")this.isScrolling=!!(this.isScrolling||Math.abs(this.deltaX)<Math.abs(a.touches[0].pageY-this.start.pageY));if(this.locked===void 0)this.locked=this.direction==1&&this.deltaX<0||this.direction==2&&this.deltaX>this.width;if(!this.isScrolling&&!this.locked){var f=this.deltaX*100/this.width;if(f<80&&!this.activated&&this.direction==1)this.activated=true;else if(f>20&&this.activated&&
this.direction==2)this.activated=false;if(f>-5&&f<this.foldedPosition+5)this.element.style.MozTransform=this.element.style.webkitTransform="translate3d("+(this.deltaX<0?0:this.deltaX)+"px,0,0)",this.isSliding=true;a.stopPropagation();a.stopImmediatePropagation();a.preventDefault();return false}}},onTouchEnd:function(a){this.locked=void 0;this.direction=0;(this.isScrolling=void 0)||this.slide();this.isSliding&&(a.stopPropagation(),a.stopImmediatePropagation(),a.preventDefault());this.isSliding=false}}})();
(function(){Handlebars.registerHelper("action",function(a,f,d){var e;var c;var b=null;!d&&f.hash&&(d=f,f=this);if(typeof a=="string"){var b=a.split("."),i=b[0]||"";i==="view"?(b.shift(),a=this.view.get(b.join(".")),b.pop(),c=(b=b.join("."))?this.view.get(b):this.view,b=c):i=="controller"?(b.shift(),a=this.controller.get(b.join(".")),b.pop(),e=(b=b.join("."))?this.controller.get(b):this.controller,b=e):(a=Pa.get(a),b.pop(),b=Pa.get(b.join(".")))}return new Handlebars.SafeString(this.view._addAction(d.hash.on,
a,f,b))})})();(function(){Handlebars.registerHelper("bindAttr",function(a){var f=[];Object.keys(a.hash).forEach(function(d){f.push({attribute:d,value:a.hash[d]})});return new Handlebars.SafeString(this.view._addAttributeBindings(f))});Handlebars.registerHelper("bind",function(a){var b;var f=this.view,d=a.split("."),a=d.pop();d.indexOf("view")==0&&d.shift();b=(d=d.join("."))?f.get(d):f,d=b;f=this.view._addMetamorph(d,a);return new Handlebars.SafeString(f.renderWrapper())})})();
(function(){Handlebars.registerHelper("collection",function(a,f){if(arguments.length==1)f=a,a=Pa.CollectionView;var d={},b=null,i,e=null,b=this.view;if(!b.isView)throw Error("currentView is not a view :)");if(f.fn)d._childTemplate=f.fn;Object.keys(f.hash).forEach(function(a){d[a]=f.hash[a]});if(!d.controller)d.controller=this.controller;if(!a.apply)throw Error("collection view is already instantiated");if(d.bindToView)e=d.bindToView,delete d.bindToView;i=a.create(d);e&&b.set(e,i);b.appendChild(i);
return new Handlebars.SafeString(i.renderWrapper().outerHTML)})})();(function(){Handlebars.registerHelper("outlet",function(a,f){var d="view";typeof a=="string"&&(d=a);if(a.fn||f&&f.fn)throw Error("Outlet can not be a block");var b=null,b=this.view;if(!b.isView)throw Error("currentView is not a view :)");this.controller.set("view",null);d=b._addMetamorph(this.controller,d);return new Handlebars.SafeString(d.renderWrapper())})})();
(function(){Handlebars.registerHelper("view",function(a,f){if(!a)throw Error("Unknown view");var d={},b=null,i=null,b=this.view;if(!b.isView)throw Error("currentView is not a view :)");if(f.fn)d.template=f.fn;Object.keys(f.hash).forEach(function(a){d[a]=f.hash[a]});if(!d.controller)d.controller=this.controller;if(d.bindToView)i=d.bindToView,delete d.bindToView;var e=a.create(d);i&&b.set(i,e);b.appendChild(e);return new Handlebars.SafeString(e.renderWrapper().outerHTML)})})();
